<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting monotone GAM models with MGCV • monogamy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fitting monotone GAM models with MGCV">
<meta property="og:description" content="monogamy">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">monogamy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/monotonic-gam-models.html">Fitting monotone GAM models with MGCV</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gzt/monogamy/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting monotone GAM models with MGCV</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gzt/monogamy/blob/master/vignettes/monotonic-gam-models.Rmd"><code>vignettes/monotonic-gam-models.Rmd</code></a></small>
      <div class="hidden name"><code>monotonic-gam-models.Rmd</code></div>

    </div>

    
    
<pre><code>#&gt; Loading required package: monogamy
#&gt; 
#&gt; Attaching package: 'dplyr'
#&gt; The following objects are masked from 'package:stats':
#&gt; 
#&gt;     filter, lag
#&gt; The following objects are masked from 'package:base':
#&gt; 
#&gt;     intersect, setdiff, setequal, union
#&gt; Loading required package: nlme
#&gt; 
#&gt; Attaching package: 'nlme'
#&gt; The following object is masked from 'package:dplyr':
#&gt; 
#&gt;     collapse
#&gt; This is mgcv 1.8-31. For overview type 'help("mgcv-package")'.</code></pre>
<div id="basic-model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-model-fitting" class="anchor"></a>Basic Model Fitting</h2>
<p>This example from the <code>mgcv</code> package demonstrates fitting a monotonic GAM model with two different settings for the <code>k</code> parameter.</p>
<p><img src="monotonic-gam-models_files/figure-html/plotfunction-1.png" width="326.4"><img src="monotonic-gam-models_files/figure-html/plotfunction-2.png" width="326.4"></p>
<p>This is an artificial data set, though, and the ground truth is that the curve is monotonic. Here we present some real data where the relationships between the variables are expected to be monotonic but may not be.</p>
</div>
<div id="application-to-image-comparison-data" class="section level2">
<h2 class="hasAnchor">
<a href="#application-to-image-comparison-data" class="anchor"></a>Application to Image Comparison Data</h2>
<table class="table">
<thead><tr class="header">
<th align="right">base_img</th>
<th align="right">img_no</th>
<th align="left">base_name</th>
<th align="left">distorted</th>
<th align="right">MOS</th>
<th align="right">SD</th>
<th align="left">metric</th>
<th align="right">score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">image-1.png</td>
<td align="left">image-1-1.png</td>
<td align="right">62.364</td>
<td align="right">18.266</td>
<td align="left">catsim</td>
<td align="right">0.691</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">image-1.png</td>
<td align="left">image-1-1.png</td>
<td align="right">62.364</td>
<td align="right">18.266</td>
<td align="left">catsimrand</td>
<td align="right">0.528</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">image-1.png</td>
<td align="left">image-1-1.png</td>
<td align="right">62.364</td>
<td align="right">18.266</td>
<td align="left">catsimacc</td>
<td align="right">0.854</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">image-1.png</td>
<td align="left">image-1-1.png</td>
<td align="right">62.364</td>
<td align="right">18.266</td>
<td align="left">Accuracy</td>
<td align="right">0.879</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">image-1.png</td>
<td align="left">image-1-1.png</td>
<td align="right">62.364</td>
<td align="right">18.266</td>
<td align="left">AdjRand</td>
<td align="right">0.574</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">image-1.png</td>
<td align="left">image-1-1.png</td>
<td align="right">62.364</td>
<td align="right">18.266</td>
<td align="left">Cohen</td>
<td align="right">0.761</td>
</tr>
</tbody>
</table>
<p>Here we have, in long format, a set of image quality metrics for a set of 180 distorted binary images. There are 12 “ground truth” images and 15 distorted versions of them. A number of people were surveyed for their opinion of the quality of the distorted images compared to the baseline on a scale from 0 - 100. The mean for each image is in the column <code>MOS</code> - designated the ‘Mean Opinion Score’ or MOS - and the standard deviation of their rating is captured in the column <code>std</code>. We then compute a set of image quality metrics whose scores are in ‘score’ and whose names are in ‘metric’.</p>
<p><img src="image-1.png" title="Baseline Image #1" alt="Baseline Image #1"><img src="image-1-8.png" title="Distorted Image #1-8" alt="Distorted Image #1-8"></p>
<p>Here are two example images the respondents would have been shown: the baseline image on the left and the distorted image on the right. This image had a MOS rating of 52.</p>
<p>We expect there to be a correspondence between the image quality metrics and the MOS and that it should be monotonic, though it may be curved and may have a lot of noise in it. The quality of the images is very low compared to what might be typical for full color or grayscale images.</p>
<pre><code>#&gt; `geom_smooth()` using formula 'y ~ s(x, bs = "cs")'
#&gt; `geom_smooth()` using formula 'y ~ x'</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/plotmetrics-1.png" width="576"></p>
<p>There is a GAM model on the plot and it’s fitted by generalized cross validation, but it has a problem: the fit really ought to be monotonic, though it’s interesting if it isn’t. We should have some sense of how well a monotonic fit works for this data and then can judge which metric best explains the variation in MOS. We can get a sense of how well each method relates to the MOS rating by looking at their correlations:</p>
<table class="table">
<thead><tr class="header">
<th align="left">metric</th>
<th align="right">Spearman</th>
<th align="right">Kendall</th>
<th align="right">Pearson</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">catsimjacc</td>
<td align="right">0.368</td>
<td align="right">0.253</td>
<td align="right">0.383</td>
</tr>
<tr class="even">
<td align="left">Jaccard</td>
<td align="right">0.395</td>
<td align="right">0.271</td>
<td align="right">0.440</td>
</tr>
<tr class="odd">
<td align="left">cwssim</td>
<td align="right">0.439</td>
<td align="right">0.308</td>
<td align="right">0.510</td>
</tr>
<tr class="even">
<td align="left">Accuracy</td>
<td align="right">0.503</td>
<td align="right">0.362</td>
<td align="right">0.500</td>
</tr>
<tr class="odd">
<td align="left">Cohen</td>
<td align="right">0.523</td>
<td align="right">0.362</td>
<td align="right">0.577</td>
</tr>
<tr class="even">
<td align="left">AdjRand</td>
<td align="right">0.559</td>
<td align="right">0.393</td>
<td align="right">0.557</td>
</tr>
<tr class="odd">
<td align="left">catsimacc</td>
<td align="right">0.561</td>
<td align="right">0.400</td>
<td align="right">0.601</td>
</tr>
<tr class="even">
<td align="left">catsim</td>
<td align="right">0.564</td>
<td align="right">0.395</td>
<td align="right">0.598</td>
</tr>
<tr class="odd">
<td align="left">catsimrand</td>
<td align="right">0.577</td>
<td align="right">0.412</td>
<td align="right">0.580</td>
</tr>
<tr class="even">
<td align="left">msssim</td>
<td align="right">0.598</td>
<td align="right">0.425</td>
<td align="right">0.578</td>
</tr>
</tbody>
</table>
<p>A non-parametric correlation such as Spearman’s, since we want a monotonic relationship, says more about the correspondence of the metrics to the MOS in the way that we are interested in. However, we are probably interested in a flexible model explaining their relationship, so here we fit a monotonic GAM with <code>k = 20</code> and compare the deviance explained by the model to an unconstrained GAM with the same parameters.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Metric</th>
<th align="right">GAM % Deviance</th>
<th align="right">mono-GAM % Deviance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CatSIM (Cohen)</td>
<td align="right">0.458</td>
<td align="right">0.151</td>
</tr>
<tr class="even">
<td align="left">CatSIM (AdjRand)</td>
<td align="right">0.380</td>
<td align="right">0.380</td>
</tr>
<tr class="odd">
<td align="left">CatSIM (Accuracy)</td>
<td align="right">0.361</td>
<td align="right">0.361</td>
</tr>
<tr class="even">
<td align="left">Accuracy</td>
<td align="right">0.403</td>
<td align="right">0.340</td>
</tr>
<tr class="odd">
<td align="left">Adjusted Rand</td>
<td align="right">0.447</td>
<td align="right">0.381</td>
</tr>
<tr class="even">
<td align="left">Cohen’s kappa</td>
<td align="right">0.482</td>
<td align="right">-1.044</td>
</tr>
<tr class="odd">
<td align="left">MS-SSIM</td>
<td align="right">0.413</td>
<td align="right">-0.275</td>
</tr>
<tr class="even">
<td align="left">CW-SSIM</td>
<td align="right">0.318</td>
<td align="right">0.318</td>
</tr>
<tr class="odd">
<td align="left">CatSIM (Jaccard)</td>
<td align="right">0.248</td>
<td align="right">-0.583</td>
</tr>
<tr class="even">
<td align="left">Jaccard</td>
<td align="right">0.390</td>
<td align="right">0.320</td>
</tr>
</tbody>
</table>
<p>For most of the models, there is not much difference between the fit of the monotonic GAM and the unconstrained GAM. A discrepancy between the two indicates there is some region where the image quality metric fails to be monotonic in its relation to the MOS.</p>
<p>One can ask about fitting the reverse, explaining the metric by the MOS, and that table can be seen here, though these results cannot be directly compared across the metrics because the response variable is not the same:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Metric</th>
<th align="right">GAM % Deviance</th>
<th align="right">mono-GAM % Deviance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CatSIM (Cohen)</td>
<td align="right">0.436</td>
<td align="right">0.402</td>
</tr>
<tr class="even">
<td align="left">CatSIM (AdjRand)</td>
<td align="right">0.427</td>
<td align="right">0.291</td>
</tr>
<tr class="odd">
<td align="left">CatSIM (Accuracy)</td>
<td align="right">0.421</td>
<td align="right">0.404</td>
</tr>
<tr class="even">
<td align="left">Accuracy</td>
<td align="right">0.362</td>
<td align="right">0.270</td>
</tr>
<tr class="odd">
<td align="left">Adjusted Rand</td>
<td align="right">0.389</td>
<td align="right">0.364</td>
</tr>
<tr class="even">
<td align="left">Cohen’s kappa</td>
<td align="right">0.393</td>
<td align="right">0.375</td>
</tr>
<tr class="odd">
<td align="left">MS-SSIM</td>
<td align="right">0.420</td>
<td align="right">0.401</td>
</tr>
<tr class="even">
<td align="left">CW-SSIM</td>
<td align="right">0.336</td>
<td align="right">0.310</td>
</tr>
<tr class="odd">
<td align="left">CatSIM (Jaccard)</td>
<td align="right">0.147</td>
<td align="right">0.147</td>
</tr>
<tr class="even">
<td align="left">Jaccard</td>
<td align="right">0.230</td>
<td align="right">0.229</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting-the-monotonic-gam" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-monotonic-gam" class="anchor"></a>Plotting the monotonic GAM</h2>
<p>We can plot the monotonic GAMs and unconstrained GAMs for each metric here:</p>
<p><img src="monotonic-gam-models_files/figure-html/monogamyplots-1.png" width="768"><img src="monotonic-gam-models_files/figure-html/monogamyplots-2.png" width="768"><img src="monotonic-gam-models_files/figure-html/monogamyplots-3.png" width="768"><img src="monotonic-gam-models_files/figure-html/monogamyplots-4.png" width="768"><img src="monotonic-gam-models_files/figure-html/monogamyplots-5.png" width="768"></p>
<p>For several of these, there is no difference between the constrained and unconstrained models since they were already monotonic.</p>
<div id="plots-with-mos-as-the-x-axis" class="section level3">
<h3 class="hasAnchor">
<a href="#plots-with-mos-as-the-x-axis" class="anchor"></a>Plots with MOS as the x-axis</h3>
<p>We can also investigate if we modeled it the other direction.</p>
<p><img src="monotonic-gam-models_files/figure-html/revplost-1.png" width="768"><img src="monotonic-gam-models_files/figure-html/revplost-2.png" width="768"><img src="monotonic-gam-models_files/figure-html/revplost-3.png" width="768"><img src="monotonic-gam-models_files/figure-html/revplost-4.png" width="768"><img src="monotonic-gam-models_files/figure-html/revplost-5.png" width="768"></p>
</div>
</div>
<div id="unconstrained-gam-diagnostics" class="section level2">
<h2 class="hasAnchor">
<a href="#unconstrained-gam-diagnostics" class="anchor"></a>Unconstrained GAM diagnostics</h2>
<p>These diagnostics can be inspected for completeness, but they all seem to check out, as expected.</p>
<pre><code>#&gt; catsim</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-1.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 4 iterations.
#&gt; The RMS GCV score gradient at convergence was 0.0001692862 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;        k'  edf k-index p-value
#&gt; s(x) 19.0 11.8    1.05    0.65
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; catsimrand</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-2.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 6 iterations.
#&gt; The RMS GCV score gradient at convergence was 0.0006867732 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;         k'   edf k-index p-value
#&gt; s(x) 19.00  2.96    1.01    0.47
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; catsimacc</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-3.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 16 iterations.
#&gt; The RMS GCV score gradient at convergence was 2.055485e-05 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;      k' edf k-index p-value
#&gt; s(x) 19   1    0.91     0.2
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; Accuracy</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-4.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 5 iterations.
#&gt; The RMS GCV score gradient at convergence was 0.0001719676 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;         k'   edf k-index p-value
#&gt; s(x) 19.00  7.01    0.96     0.3
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; AdjRand</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-5.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 8 iterations.
#&gt; The RMS GCV score gradient at convergence was 3.587589e-05 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;        k'  edf k-index p-value
#&gt; s(x) 19.0 11.1    1.08    0.78
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; Cohen</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-6.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 4 iterations.
#&gt; The RMS GCV score gradient at convergence was 8.973081e-05 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;        k'  edf k-index p-value
#&gt; s(x) 19.0 14.1       1    0.53
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; msssim</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-7.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 7 iterations.
#&gt; The RMS GCV score gradient at convergence was 5.852033e-05 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;         k'   edf k-index p-value
#&gt; s(x) 19.00  7.62    1.05    0.71
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; cwssim</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-8.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 6 iterations.
#&gt; The RMS GCV score gradient at convergence was 0.005321628 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;         k'   edf k-index p-value
#&gt; s(x) 19.00  3.89    1.02    0.56
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; catsimjacc</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-9.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 8 iterations.
#&gt; The RMS GCV score gradient at convergence was 0.0001738293 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;         k'   edf k-index p-value
#&gt; s(x) 19.00  6.82    1.02    0.56
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; Jaccard</code></pre>
<p><img src="monotonic-gam-models_files/figure-html/unrestrictedGAMplot-10.png" width="576"></p>
<pre><code>#&gt; 
#&gt; Method: GCV   Optimizer: magic
#&gt; Smoothing parameter selection converged after 7 iterations.
#&gt; The RMS GCV score gradient at convergence was 0.0007458122 .
#&gt; The Hessian was positive definite.
#&gt; Model rank =  20 / 20 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k'.
#&gt; 
#&gt;         k'   edf k-index p-value
#&gt; s(x) 19.00  6.79    1.29    0.99</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
